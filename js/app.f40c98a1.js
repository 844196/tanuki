webpackJsonp([1],{0:function(t,a,e){t.exports=e("x35b")},KAUX:function(t,a){},Q4LD:function(t,a){},doPI:function(t,a){},x35b:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=e("/5sW"),n=e("MMSg"),r=e.n(n);e("doPI");i["a"].use(r.a);var s=i["a"].extend({name:"App"}),l=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("router-view")},d=[],o=e("XyMi"),h=!1,c=null,u=null,p=null,f=Object(o["a"])(s,l,d,h,c,u,p),g=f.exports,m=e("/ocq"),b=e("fKPv"),v=e.n(b),y=(e("mJx5"),e("EuXz"),e("U6qc"),e("Z60a")),x=e.n(y),_=e("C9uT"),O=e.n(_),j={name:"SortableTree",props:{data:{type:Object},attr:{type:String,default:"name"},closeStateKey:{type:String,default:""},childrenAttr:{type:String,default:"children"},mixinParentKey:{type:String,default:""},draggable:{type:Boolean,default:!0},parentData:{type:Object},idx:{type:Number,default:-1},dragInfo:{type:Object,default:()=>{return{data:null,vm:null,vmIdx:-1,parentData:null}}}},data(){return{dragObj:this.dragInfo}},computed:{children(){let t=this.data[this.childrenAttr];if(!t||!t.length)return[];let a=[];return t.forEach(t=>a.push({_replaceLi_:!0},t)),a.push({_replaceLi_:!0}),a},isParent(){return this.data===this.dragObj.parentData},isNextToMe(){return this.parentData===this.dragObj.parentData&&1===Math.abs(this.idx-this.dragObj.vmIdx)},isMeOrMyAncestor(){let t=this;while(t){let a=t.data;if(a===this.dragObj.data)return!0;t=t.$parent}return!1},isAllowToDrop(){return!(this.isNextToMe||this.isParent||this.isMeOrMyAncestor)}},methods:{changePosition(t){this.$emit("changePosition",t)},hasChildren(t){return t[this.childrenAttr]&&t[this.childrenAttr].length},dragStart(t){if(this.data["_replaceLi_"])return t.preventDefault();t.dataTransfer.setData("text/plain",null),this.dragObj.data=this.data,this.dragObj.vm=this.$el,this.dragObj.vmIdx=this.idx,this.dragObj.parentData=this.parentData,this.dragObj.pastIdx=(this.idx-1)/2},dragEnter(){this.dragObj.vm&&this.dragObj.vm.classList.add("draging"),this.isAllowToDrop&&this.$el&&this.$el.classList.add("droper")},dragLeave(t){this.$el&&this.$el.classList.remove("droper")},drop(){if(this.dragObj.vm&&this.dragObj.vm.classList.remove("draging"),this.$el&&this.$el.classList.remove("droper"),!this.isAllowToDrop)return;let t=this.dragObj.parentData[this.childrenAttr].indexOf(this.dragObj.data);this.dragObj.parentData[this.childrenAttr].splice(t,1);let a=this.parentData;if(this.data["_replaceLi_"])if(this.dragObj.parentData===this.parentData){let a=this.idx/2;t>a?this.parentData[this.childrenAttr].splice(a,0,this.dragObj.data):this.parentData[this.childrenAttr].splice(a-1,0,this.dragObj.data)}else this.parentData[this.childrenAttr].splice(this.idx/2,0,this.dragObj.data);else a=this.data,this.data[this.childrenAttr]||i["a"].set(this.data,[this.childrenAttr],[]),this.data[this.childrenAttr].push(this.dragObj.data);this.$emit("changePosition",{beforeParent:this.dragObj.parentData,data:this.dragObj.data,afterParent:a,beforeIndex:this.dragObj.pastIdx})},dragEnd(){}},updated(){this.mixinParentKey&&(this.data[this.mixinParentKey]=this.parentData)},mounted(){this.mixinParentKey&&(this.data[this.mixinParentKey]=this.parentData)}},P=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"sortable-tree",attrs:{draggable:t.draggable&&t.parentData},on:{dragstart:function(a){a.stopPropagation(),t.dragStart(a)},dragover:function(t){t.stopPropagation(),t.preventDefault()},dragenter:function(a){a.stopPropagation(),a.preventDefault(),t.dragEnter()},dragleave:function(a){a.stopPropagation(),t.dragLeave()},drop:function(a){return a.stopPropagation(),a.preventDefault(),t.drop(a)},dragend:function(a){return a.stopPropagation(),a.preventDefault(),t.dragEnd(a)}}},[e("div",{staticClass:"content"},[t._t("default",[e("span",[t._v(t._s(t.data[t.attr]))])],{item:t.data})],2),t.hasChildren(t.data)&&(!this.closeStateKey||this.closeStateKey&&!this.data[this.closeStateKey])?e("ul",t._l(t.children,function(a,i){return e("li",{key:i,class:{"parent-li":t.hasChildren(a),"exist-li":!a["_replaceLi_"],"blank-li":a["_replaceLi_"]}},[e("sortable-tree",{attrs:{data:a,attr:t.attr,childrenAttr:t.childrenAttr,mixinParentKey:t.mixinParentKey,closeStateKey:t.closeStateKey,draggable:t.draggable,parentData:t.data,idx:i,dragInfo:t.dragInfo},on:{changePosition:t.changePosition},scopedSlots:t._u([{key:"default",fn:function(a){var i=a.item;return[t._t("default",[e("span",[t._v(t._s(i[t.attr]))])],{item:i})]}}])})],1)})):t._e()])},C=[];function D(t){e("KAUX")}var k=!1,A=D,S="data-v-ff28e532",$=null,w=Object(o["a"])(j,P,C,k,A,S,$),K=w.exports,M=function(){function t(){x()(this,t),this.name="",this.point=10,this.children=[],this.fold=!1}return O()(t,[{key:"toggleFold",value:function(){this.fold=!this.fold}},{key:"hasChild",value:function(){return this.children.length>0}},{key:"totalPoint",value:function(){return 0===this.children.length?this.point:this.children.reduce(function(t,a){return t+=a.totalPoint(),t},0)}},{key:"addChild",value:function(){this.children.push(new t)}},{key:"removeChild",value:function(t){var a=this.children.findIndex(function(a){return a===t});this.children.splice(a,1)}},{key:"toMarkdown",value:function(){var t="* ".concat(this.name,": ").concat(this.totalPoint(),"人日");return this.hasChild()&&(t+=this.children.reduce(function(t,a){return t="".concat(t,"\n").concat(a.toMarkdown()),t},"").split("\n").map(function(t){return"    "+t}).join("\n")),t}}],[{key:"from",value:function(a){var e=a.name,i=a.point,n=a.children,r=a.fold,s=new t;return s.name=e,s.point=i,s.children=n.map(function(a){return t.from(a)}),s.fold=r,s}}]),t}(),L=new M,I=i["a"].extend({name:"Home",components:v()({},K.name,K),data:function(){return{data:L}},computed:{dump:{get:function(){return JSON.stringify(this.data,function(t,a){if("$parent"!==t)return a},"  ")},set:function(t){this.data=M.from(JSON.parse(t))}}}}),E=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("main",{staticClass:"container",attrs:{id:"main"}},[e("sortable-tree",{attrs:{data:t.data,childrenAttr:"children",mixinParentKey:"$parent",closeStateKey:"fold"},scopedSlots:t._u([{key:"default",fn:function(a){var i=a.item;return[void 0!==i.name?e("div",{staticClass:"item"},[e("b-field",[i.hasChild()?e("p",{staticClass:"control",staticStyle:{"z-index":"1"}},[e("button",{staticClass:"button is-small",attrs:{disabled:!i.hasChild()},on:{click:function(t){i.toggleFold()}}},[t._v(t._s(i.fold?"▶":"▼"))])]):t._e(),i.hasChild()?e("p",{staticClass:"control"},[e("span",{staticClass:"button is-small is-static"},[t._v(t._s(i.totalPoint())+"人日")])]):t._e(),i.hasChild()?t._e():e("b-input",{attrs:{size:"is-small",min:"0",type:"number",value:i.hasChild()?i.totalPoint():i.point,disabled:i.hasChild()},on:{input:function(t){i.point=parseInt(t)}}}),i.hasChild()?t._e():e("p",{staticClass:"control"},[e("span",{staticClass:"button is-small is-static"},[t._v("人日")])]),e("b-input",{attrs:{size:"is-small",type:"text"},model:{value:i.name,callback:function(a){t.$set(i,"name",a)},expression:"item.name"}}),e("p",{staticClass:"control"},[e("button",{staticClass:"button is-small is-info",on:{click:function(t){i.addChild()}}},[t._v("+")])]),e("p",{staticClass:"control"},[e("button",{staticClass:"button is-small is-warning",on:{click:function(t){i.$parent.removeChild(i)}}},[t._v("×")])])],1)],1):t._e()]}}])}),e("hr"),e("div",[e("b-input",{attrs:{size:"is-small",type:"textarea"},model:{value:t.dump,callback:function(a){t.dump=a},expression:"dump"}})],1),e("hr"),e("div",[e("b-input",{attrs:{size:"is-small",type:"textarea",readonly:""},model:{value:t.data.toMarkdown(),callback:function(a){t.$set(t.data,"toMarkdown()",a)},expression:"data.toMarkdown()"}})],1)],1)},T=[];function z(t){e("Q4LD")}var N=!1,J=z,X="data-v-0ed8eeae",U=null,q=Object(o["a"])(I,E,T,N,J,X,U),F=q.exports,Q=[{path:"/",component:F}],B=Q;i["a"].use(m["a"]);var H=new m["a"]({mode:"hash",base:"/tanuki/",routes:B}),W=e("NYxO");i["a"].use(W["a"]);var Y=new W["a"].Store({state:{},mutations:{},actions:{}});i["a"].config.productionTip=!1,new i["a"]({router:H,store:Y,render:function(t){return t(g)}}).$mount("#app")}},[0]);
//# sourceMappingURL=app.f40c98a1.js.map